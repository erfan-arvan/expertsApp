<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Threaded Opinions ‚Äî Modern Chat Layout</title>
  <style>
    :root {
      --bg: #0b0c10;
      --panel: #151821;
      --panel-2: #10131a;
      --text: #e6e9ef;
      --muted: #a3aab9;
      --border: #232735;
      --primary: #7c5cff;
      --primary-2: #a590ff;
      --success: #22c55e;
      --danger: #ef4444;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --radius-sm: 12px;
      --radius-xs: 10px;
    }

    @media (prefers-color-scheme: light) {
      :root {
        --bg: #f6f7fb;
        --panel: #ffffff;
        --panel-2: #fbfbfe;
        --text: #0b1020;
        --muted: #606a80;
        --border: #e6e8ee;
        --shadow: 0 10px 30px rgba(9, 12, 22, .08);
      }
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, Noto Sans, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text);
      background: radial-gradient(1200px 700px at 80% -200px, rgba(124,92,255,.18), transparent 60%),
                  radial-gradient(1000px 500px at -200px 80%, rgba(79,209,197,.18), transparent 60%),
                  var(--bg);
      line-height: 1.5;
    }

    /* Layout */
    .shell {
      max-width: 1100px;
      margin: min(6vh, 48px) auto;
      padding: 0 20px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 18px;
    }

    .topic-card {
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px 18px 2px 18px;
      position: sticky;
      top: 10px;
      z-index: 1;
    }

    .topic-heading {
      display: flex;
      align-items: start;
      gap: 14px;
    }
    .topic-icon {
      width: 44px; height: 44px;
      border-radius: 12px;
      display: grid; place-items: center;
      background: linear-gradient(145deg, rgba(124,92,255,.25), rgba(124,92,255,.05));
      border: 1px solid var(--border);
      flex: 0 0 auto;
    }
    .topic-title {
      margin: 0;
      font-size: clamp(22px, 2.5vw, 28px);
      letter-spacing: -0.01em;
    }
    .topic-meta {
      margin-top: 4px;
      color: var(--muted);
      font-size: 14px;
    }

    .toolbar {
      margin-top: 14px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
    }
    .toolbar .controls { display: flex; gap: 10px; flex-wrap: wrap; }

    .chip {
      border: 1px solid var(--border);
      background: transparent;
      color: var(--text);
      padding: 8px 12px;
      border-radius: 999px;
      font-size: 14px;
      cursor: pointer;
    }

    .select {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--text);
      font-size: 14px;
      cursor: pointer;
    }

    .list-card {
      background: linear-gradient(180deg, var(--panel), var(--panel-2));
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 12px;
    }

    /* Post item */
    .post {
      display: grid;
      grid-template-columns: 48px 1fr;
      gap: 12px;
      padding: 14px;
      border-radius: var(--radius-sm);
      border: 1px solid transparent;
      transition: border-color .2s ease, background .2s ease;
    }
    .post + .post { margin-top: 6px; }
    .post:hover { border-color: var(--border); background: rgba(124,92,255,.03); }

    .avatar {
      width: 48px; height: 48px; border-radius: 50%;
      background: linear-gradient(145deg, #d1d5db, #9ca3af);
      display: grid; place-items: center;
      color: #0b0c10; font-weight: 700;
      user-select: none;
    }

    .post-body { min-width: 0; }

    .post-head {
      display: flex; align-items: center; gap: 10px; flex-wrap: wrap;
    }
    .name { font-weight: 700; }
    .badge {
      font-size: 12px; padding: 2px 8px; border-radius: 999px;
      border: 1px solid var(--border); color: var(--muted);
    }
    .time { color: var(--muted); font-size: 13px; margin-left: auto; }

    .content { margin-top: 6px; font-size: 15.5px; }

    .attachments { margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap; }
    .pill {
      font-size: 12px; border: 1px dashed var(--border); color: var(--muted);
      padding: 6px 10px; border-radius: 999px;
    }

    .post-actions {
      margin-top: 10px; display: flex; align-items: center; gap: 8px; flex-wrap: wrap;
    }
    .btn {
      display: inline-flex; align-items: center; gap: 8px;
      padding: 8px 12px; border-radius: 10px; border: 1px solid var(--border);
      background: transparent; color: var(--text); cursor: pointer; font-size: 14px;
    }
    .btn.primary { border-color: transparent; background: linear-gradient(145deg, var(--primary), var(--primary-2)); color: white; }
    .btn.ghost { opacity: .85; }
    .btn[aria-pressed="true"] { box-shadow: inset 0 0 0 2px currentColor; }

    .score { display: inline-flex; align-items: center; gap: 6px; font-size: 14px; color: var(--muted); margin-left: 2px; }
    .score .up { color: var(--success); }
    .score .down { color: var(--danger); }

    /* Replies */
    .replies {
      margin-top: 10px; padding-left: 18px; border-left: 2px dashed var(--border);
      display: grid; gap: 8px;
    }

    /* Composer */
    .composer {
      margin-top: 12px;
      display: grid; grid-template-columns: 48px 1fr; gap: 12px;
      padding: 12px; border: 1px dashed var(--border); border-radius: var(--radius-sm);
      background: rgba(124,92,255,.05);
    }
    textarea.input {
      width: 100%; min-height: 64px; resize: vertical;
      background: var(--panel-2); color: var(--text);
      border: 1px solid var(--border); border-radius: 12px;
      padding: 10px 12px; font: inherit;
    }
    .composer-actions { margin-top: 8px; display: flex; gap: 8px; align-items: center; justify-content: flex-end; }

    /* Utilities */
    .sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,1px,1px); border: 0; }
    .spacer { flex: 1; }

    /* Responsive tweaks */
    @media (max-width: 720px) {
      .topic-card { position: static; }
      .time { width: 100%; margin-left: 0; }
      .composer { grid-template-columns: 36px 1fr; }
      .avatar { width: 36px; height: 36px; font-size: 12px; }
      .post { grid-template-columns: 36px 1fr; }
    }
  </style>
</head>
<body>
  <div class="shell" role="application" aria-label="Threaded opinions">

    <!-- Topic Header -->
    <section class="topic-card" aria-labelledby="topic-title">
      <div class="topic-heading">
        <div class="topic-icon" aria-hidden="true">üí¨</div>
        <div>
          <h1 id="topic-title" class="topic-title">What‚Äôs the best way to teach code comprehension to juniors?</h1>
          <div class="topic-meta">Single-subject thread ‚Ä¢ 42 opinions ‚Ä¢ Last activity 3m ago</div>
        </div>
      </div>
      <div class="toolbar" aria-label="Tools and filters">
        <div class="controls">
          <button class="chip" aria-pressed="false" onclick="toggleChip(this)">All</button>
          <button class="chip" aria-pressed="false" onclick="toggleChip(this)">Pros</button>
          <button class="chip" aria-pressed="false" onclick="toggleChip(this)">Cons</button>
          <button class="chip" aria-pressed="false" onclick="toggleChip(this)">With replies</button>
        </div>
        <div class="controls">
          <button class="select" onclick="cycleSort(this)" aria-haspopup="listbox" aria-expanded="false" aria-label="Sort options">Sort: Top</button>
          <button class="select" onclick="cycleView(this)" aria-haspopup="listbox" aria-expanded="false" aria-label="Density options">View: Cozy</button>
        </div>
      </div>
    </section>

    <!-- Opinions List -->
    <section class="list-card" aria-live="polite">

      <!-- Post 1 -->
      <article class="post" data-score="12">
        <div class="avatar" aria-hidden="true">EA</div>
        <div class="post-body">
          <div class="post-head">
            <span class="name">Erfan A.</span>
            <span class="badge">Moderator</span>
            <time class="time" datetime="2025-08-12T09:00:00-04:00">yesterday</time>
          </div>
          <div class="content">
            Start with small, real-world Java methods and ask learners to predict outputs for tricky inputs. It forces deep reading and reveals gaps without heavy setup.
          </div>
          <div class="attachments">
            <span class="pill">#teaching</span>
            <span class="pill">#java</span>
          </div>
          <div class="post-actions">
            <button class="btn" onclick="vote(this, 1)" aria-pressed="false" aria-label="Like this opinion">üëç Like</button>
            <button class="btn" onclick="vote(this, -1)" aria-pressed="false" aria-label="Dislike this opinion">üëé Dislike</button>
            <span class="score"><span class="up" data-up>12</span>/<span class="down" data-down>1</span></span>
            <span class="spacer"></span>
            <button class="btn ghost" onclick="toggleReply(this)">‚Ü©Ô∏é Reply</button>
            <button class="btn ghost" aria-label="More actions">‚ãØ</button>
          </div>

          <div class="replies" role="group" aria-label="Replies">
            <!-- Reply A -->
            <article class="post" data-score="5">
              <div class="avatar" aria-hidden="true">MK</div>
              <div class="post-body">
                <div class="post-head">
                  <span class="name">Martin K.</span>
                  <time class="time" datetime="2025-08-12T12:30:00-04:00">22h ago</time>
                </div>
                <div class="content">+1. And add a timed constraint to simulate pressure‚Äîthey focus on the longest execution path first.</div>
                <div class="post-actions">
                  <button class="btn" onclick="vote(this, 1)">üëç Like</button>
                  <button class="btn" onclick="vote(this, -1)">üëé Dislike</button>
                  <span class="score"><span class="up" data-up>5</span>/<span class="down" data-down>0</span></span>
                  <span class="spacer"></span>
                  <button class="btn ghost" onclick="toggleReply(this)">‚Ü©Ô∏é Reply</button>
                </div>
              </div>
            </article>
          </div>

          <!-- Inline composer for replies -->
          <div class="composer" hidden>
            <div class="avatar" aria-hidden="true">YOU</div>
            <div>
              <label class="sr-only" for="reply-1">Write a reply</label>
              <textarea id="reply-1" class="input" placeholder="Write a thoughtful reply‚Ä¶"></textarea>
              <div class="composer-actions">
                <button class="btn" onclick="cancelReply(this)">Cancel</button>
                <button class="btn primary" onclick="submitReply(this)">Post reply</button>
              </div>
            </div>
          </div>
        </div>
      </article>

      <!-- Post 2 -->
      <article class="post" data-score="3">
        <div class="avatar" aria-hidden="true">ND</div>
        <div class="post-body">
          <div class="post-head">
            <span class="name">Nadeeshan D.</span>
            <time class="time" datetime="2025-08-13T09:03:00-04:00">just now</time>
          </div>
          <div class="content">I‚Äôd pair prediction tasks with short ‚Äúexplain the bug‚Äù prompts‚Äîlearners justify reasoning, not only answers. Threading replies keeps ideas tight under one subject.</div>
          <div class="post-actions">
            <button class="btn" onclick="vote(this, 1)">üëç Like</button>
            <button class="btn" onclick="vote(this, -1)">üëé Dislike</button>
            <span class="score"><span class="up" data-up>3</span>/<span class="down" data-down>1</span></span>
            <span class="spacer"></span>
            <button class="btn ghost" onclick="toggleReply(this)">‚Ü©Ô∏é Reply</button>
            <button class="btn ghost">‚ãØ</button>
          </div>

          <div class="composer" hidden>
            <div class="avatar" aria-hidden="true">YOU</div>
            <div>
              <label class="sr-only" for="reply-2">Write a reply</label>
              <textarea id="reply-2" class="input" placeholder="Write a thoughtful reply‚Ä¶"></textarea>
              <div class="composer-actions">
                <button class="btn" onclick="cancelReply(this)">Cancel</button>
                <button class="btn primary" onclick="submitReply(this)">Post reply</button>
              </div>
            </div>
          </div>
        </div>
      </article>

    </section>

    <!-- New Opinion Composer (root-level) -->
    <section class="list-card" aria-label="Add new opinion">
      <div class="composer">
        <div class="avatar" aria-hidden="true">YOU</div>
        <div>
          <label class="sr-only" for="new-opinion">Share your opinion</label>
          <textarea id="new-opinion" class="input" placeholder="Share your opinion‚Ä¶"></textarea>
          <div class="composer-actions">
            <button class="btn">Attach</button>
            <span class="spacer"></span>
            <button class="btn primary" onclick="addRootOpinion()">Post opinion</button>
          </div>
        </div>
      </div>
    </section>

  </div>

  <script>
    // Minimal client-side interactions for demo purposes only.
    function vote(el, delta) {
      const post = el.closest('.post');
      const up = post.querySelector('[data-up]');
      const down = post.querySelector('[data-down]');
      const upN = parseInt(up?.textContent || '0', 10);
      const downN = parseInt(down?.textContent || '0', 10);

      // Simple toggle behavior
      if (delta > 0) { up.textContent = upN + 1; el.setAttribute('aria-pressed', 'true'); }
      if (delta < 0) { down.textContent = downN + 1; el.setAttribute('aria-pressed', 'true'); }
    }

    function toggleReply(btn) {
      const post = btn.closest('.post');
      const composer = post.querySelector('.composer');
      if (composer) composer.hidden = !composer.hidden;
    }
    function cancelReply(el) {
      const card = el.closest('.composer');
      const ta = card.querySelector('textarea');
      ta.value = '';
      card.hidden = true;
    }
    function submitReply(btn) {
      const composer = btn.closest('.composer');
      const text = composer.querySelector('textarea').value.trim();
      if (!text) return;
      const replies = composer.previousElementSibling?.classList.contains('replies')
        ? composer.previousElementSibling
        : (() => { const d = document.createElement('div'); d.className = 'replies'; composer.before(d); return d; })();

      replies.insertAdjacentHTML('beforeend', `
        <article class="post">
          <div class="avatar">YOU</div>
          <div class="post-body">
            <div class="post-head">
              <span class="name">You</span>
              <time class="time">just now</time>
            </div>
            <div class="content"></div>
            <div class="post-actions">
              <button class="btn" onclick="vote(this, 1)">üëç Like</button>
              <button class="btn" onclick="vote(this, -1)">üëé Dislike</button>
              <span class="score"><span class="up" data-up>0</span>/<span class="down" data-down>0</span></span>
              <span class="spacer"></span>
              <button class="btn ghost" onclick="toggleReply(this)">‚Ü©Ô∏é Reply</button>
            </div>
          </div>
        </article>`);
      replies.lastElementChild.querySelector('.content').textContent = text;
      composer.querySelector('textarea').value = '';
      composer.hidden = true;
    }

    function addRootOpinion() {
      const ta = document.getElementById('new-opinion');
      const text = ta.value.trim();
      if (!text) return;
      const list = document.querySelectorAll('.list-card')[0];
      list.insertAdjacentHTML('beforeend', `
        <article class="post">
          <div class="avatar">YOU</div>
          <div class="post-body">
            <div class="post-head">
              <span class="name">You</span>
              <time class="time">just now</time>
            </div>
            <div class="content"></div>
            <div class="post-actions">
              <button class="btn" onclick="vote(this, 1)">üëç Like</button>
              <button class="btn" onclick="vote(this, -1)">üëé Dislike</button>
              <span class="score"><span class="up" data-up>0</span>/<span class="down" data-down>0</span></span>
              <span class="spacer"></span>
              <button class="btn ghost" onclick="toggleReply(this)">‚Ü©Ô∏é Reply</button>
              <button class="btn ghost">‚ãØ</button>
            </div>
          </div>
        </article>`);
      list.lastElementChild.querySelector('.content').textContent = text;
      ta.value = '';
      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    function toggleChip(btn) {
      const pressed = btn.getAttribute('aria-pressed') === 'true';
      btn.setAttribute('aria-pressed', String(!pressed));
    }

    const sortModes = ['Top', 'Newest', 'Oldest', 'Most Replies'];
    function cycleSort(btn) {
      const current = btn.textContent.split(': ')[1];
      const idx = (sortModes.indexOf(current) + 1) % sortModes.length;
      btn.textContent = 'Sort: ' + sortModes[idx];
    }

    const views = ['Cozy', 'Compact', 'Comfy'];
    function cycleView(btn) {
      const current = btn.textContent.split(': ')[1];
      const idx = (views.indexOf(current) + 1) % views.length;
      btn.textContent = 'View: ' + views[idx];
      document.querySelectorAll('.post').forEach(p => {
        if (views[idx] === 'Compact') p.style.padding = '8px';
        else if (views[idx] === 'Comfy') p.style.padding = '18px';
        else p.style.padding = '14px';
      });
    }
  </script>
</body>
</html>